* Flatten list
* Keep track of levels
* Do a reduction into buckets, then its trivial from there